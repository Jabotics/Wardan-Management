import { useEffect, useState } from 'react'
import { IconChevronsLeft, IconMenu2, IconX } from '@tabler/icons-react'
import { Layout, LayoutHeader } from './custom/layout'
import { Button } from './custom/button'
import Nav from './nav'
import { cn } from '@/lib/utils'
import { sidelinks } from '@/data/sidelinks'

interface SidebarProps extends React.HTMLAttributes<HTMLElement> {
  isCollapsed: boolean
  setIsCollapsed: React.Dispatch<React.SetStateAction<boolean>>
}

export default function Sidebar2({
  className,
  isCollapsed,
  setIsCollapsed,
}: SidebarProps) {
  const [navOpened, setNavOpened] = useState(false)

  /* Make body not scrollable when navBar is opened */
  useEffect(() => {
    if (navOpened) {
      document.body.classList.add('overflow-hidden')
    } else {
      document.body.classList.remove('overflow-hidden')
    }
  }, [navOpened])

  return (
    <aside
      className={cn(
        `fixed left-0 right-0 top-0 z-50 w-full border-r-2 border-r-muted transition-[width] md:bottom-0 md:right-auto md:h-svh ${isCollapsed ? 'md:w-14' : 'md:w-64'}`,
        className
      )}
    >
      {/* Overlay in mobile */}
      <div
        onClick={() => setNavOpened(false)}
        className={`absolute inset-0 transition-[opacity] delay-100 duration-700 ${navOpened ? 'h-svh opacity-50' : 'h-0 opacity-0'} w-full bg-black md:hidden`}
      />

      <Layout>
        {/* Header */}
        <LayoutHeader className='sticky top-0 justify-between px-4 py-3 shadow md:px-4'>
          <div className={`flex items-center ${!isCollapsed ? 'gap-2' : ''}`}>
            {/* <svg
              viewBox='0 0 71 82'
              fill='none'
              xmlns='http://www.w3.org/2000/svg'
              className={`transition-all ${isCollapsed ? 'h-6 w-6' : 'h-8 w-8'}`}
            >
              <path
                d='M0 0 C4.04404585 2.58788755 7.37200551 5.88504814 8.74609375 10.55859375 C8.86082031 11.14640625 8.97554688 11.73421875 9.09375 12.33984375 C11.22514019 10.28457464 13.09151768 8.34306821 14.78125 5.90234375 C19.68627117 0.46705002 26.21248852 -2.42520212 33.44921875 -2.86328125 C42.25002863 -2.97093642 50.10328029 -2.88738353 57.40625 2.58984375 C66.85807262 12.26147619 66.38336586 24.17014504 66.2890625 36.875 C66.28532537 38.36429147 66.28248171 39.85358543 66.28048706 41.34288025 C66.27290567 45.23415088 66.25330544 49.12526864 66.2310791 53.01647949 C66.21050127 56.99859551 66.20145999 60.98073659 66.19140625 64.96289062 C66.17005347 72.7552856 66.13491721 80.54752365 66.09375 88.33984375 C58.50375 88.33984375 50.91375 88.33984375 43.09375 88.33984375 C43.07916748 86.59968994 43.06458496 84.85953613 43.04956055 83.06665039 C42.99770381 77.28701103 42.93236367 71.50760651 42.85803509 65.72821903 C42.81349892 62.22760935 42.77420731 58.72711156 42.74731445 55.22631836 C42.71608683 51.19225498 42.66130599 47.15879839 42.60546875 43.125 C42.59907883 41.88089859 42.5926889 40.63679718 42.58610535 39.35499573 C42.51715302 29.4648579 42.51715302 29.4648579 39.09375 20.33984375 C34.64011895 17.57502232 30.18343138 17.83248627 25.09375 18.33984375 C19.86492787 20.08278446 17.61611111 22.47529017 15.09375 27.33984375 C12.8763782 34.31312995 12.75652474 41.33665062 12.6796875 48.59375 C12.66032135 49.73520981 12.6409552 50.87666962 12.6210022 52.05271912 C12.56161402 55.6691866 12.51498465 59.28568661 12.46875 62.90234375 C12.4305327 65.36654971 12.39147883 67.83074285 12.3515625 70.29492188 C12.25438465 76.30982601 12.17449143 82.32460709 12.09375 88.33984375 C4.50375 88.33984375 -3.08625 88.33984375 -10.90625 88.33984375 C-10.92083252 86.49310059 -10.93541504 84.64635742 -10.95043945 82.74365234 C-11.002173 76.62871164 -11.0674809 70.51403256 -11.14196491 64.39932823 C-11.18661274 60.69348722 -11.22588077 56.98775472 -11.25268555 53.28173828 C-11.27877489 49.70239642 -11.31921603 46.12347339 -11.36943626 42.54439163 C-11.38606715 41.18177136 -11.39760493 39.8190787 -11.40386391 38.45637131 C-11.41354531 36.54159724 -11.44333538 34.6269573 -11.47387695 32.71240234 C-11.49053154 31.08025284 -11.49053154 31.08025284 -11.50752258 29.41513062 C-11.973012 25.82492483 -13.02846572 23.4234057 -14.90625 20.33984375 C-19.40123084 17.34318986 -23.63991377 17.77269985 -28.90625 18.33984375 C-32.47898087 19.31303735 -34.96591785 20.91240361 -37.05889893 24.08958435 C-40.34517089 30.90792217 -40.50796877 37.20751969 -40.515625 44.6875 C-40.53216125 45.93994003 -40.54869751 47.19238007 -40.56573486 48.48277283 C-40.60585884 51.78222295 -40.62933333 55.08121844 -40.64447021 58.38085938 C-40.66416101 61.75992241 -40.7061166 65.13870499 -40.74609375 68.51757812 C-40.81980816 75.12496852 -40.86948247 81.73214865 -40.90625 88.33984375 C-48.82625 88.33984375 -56.74625 88.33984375 -64.90625 88.33984375 C-64.90625 58.96984375 -64.90625 29.59984375 -64.90625 -0.66015625 C-57.31625 -0.66015625 -49.72625 -0.66015625 -41.90625 -0.66015625 C-41.57625 2.63984375 -41.24625 5.93984375 -40.90625 9.33984375 C-40.205 8.43234375 -39.50375 7.52484375 -38.78125 6.58984375 C-29.59461434 -4.35154254 -12.58143781 -5.89230671 0 0 Z '
                fill='#0C0C0C'
                transform='translate(428.90625,249.66015625)'
              />
              <path
                d='M0 0 C3.34625024 2.52676039 4.67977847 4.03933542 6 8 C7.03594952 20.53754824 4.90445555 31.92806399 1.95767212 44.07330322 C0.86748496 48.56995267 -0.17848668 53.07665017 -1.22914124 57.58267212 C-1.82099826 60.11831496 -2.41509709 62.65343537 -3.01121521 65.18807983 C-7.16779508 82.86833401 -11.10470577 100.59862991 -15.06197357 118.32432938 C-15.68633028 121.11976281 -16.31156689 123.91499805 -16.93707275 126.71017456 C-22.84066203 153.09571272 -28.64837394 179.49587892 -34 206 C-32.16274609 202.57242924 -30.88991474 199.04088875 -29.6015625 195.375 C-29.12429256 194.02908586 -28.64640066 192.68339216 -28.16796875 191.33789062 C-27.91708496 190.63124268 -27.66620117 189.92459473 -27.40771484 189.1965332 C-18.46624269 164.10407377 -7.88655045 139.84331333 4 116 C4.43022461 115.13552246 4.86044922 114.27104492 5.30371094 113.38037109 C34.21530068 55.74903277 34.21530068 55.74903277 58.796875 44.66796875 C63.91675192 43.11566564 69.12252676 42.78424101 74.1171875 44.89453125 C79.47061986 48.69707655 81.56228051 54.51738106 82.70263672 60.79931641 C86.33176093 87.65721927 80.20960706 116.4950797 76.5078125 143.109375 C76.39616886 143.91219847 76.28452522 144.71502193 76.16949844 145.54217339 C75.02642484 153.75267927 73.87443978 161.9618224 72.69803429 170.16762352 C72.25079339 173.29144634 71.80752939 176.41582737 71.36468124 179.54027557 C71.15524309 181.009382 70.94375679 182.47819811 70.73007584 183.94669342 C69.20349926 194.42752925 69.20349926 194.42752925 69 205 C70.65 205.33 72.3 205.66 74 206 C75.08020592 208.65896843 75.23626424 210.38686548 74.19921875 213.078125 C72.95887328 215.32448357 71.78382896 217.15138306 70 219 C66.1875 220 66.1875 220 63 220 C58.48129488 214.53989798 59.70188516 207.71841175 60.23583984 201.05834961 C60.59381318 197.65760292 61.00761242 194.26742209 61.4375 190.875 C61.60534438 189.51188624 61.77314838 188.1487675 61.94091797 186.78564453 C63.25811036 176.23902426 64.72604894 165.71323313 66.19921875 155.1875 C66.39846662 153.76132396 66.59770053 152.33514597 66.79692078 150.90896606 C67.69968845 144.4521882 68.60643501 137.99606289 69.52931881 131.54212666 C77.89693654 91.49696485 77.89693654 91.49696485 71 53 C67.68620657 51.85031657 65.3041697 51.57510102 61.92578125 52.67578125 C34.81375916 66.0614295 18.57442154 105.85918656 6 131 C5.58298828 131.82081055 5.16597656 132.64162109 4.73632812 133.48730469 C-13.75233111 169.96796073 -26.87616258 209.88710282 -38.04345703 249.1315918 C-38.27972305 249.94815247 -38.51598907 250.76471313 -38.75941467 251.60601807 C-39.19816616 253.12354161 -39.62873046 254.64346889 -40.04905701 256.16619873 C-41.36248153 260.68111425 -43.03711991 264.25867267 -46 268 C-46.99 268.33 -47.98 268.66 -49 269 C-49.99 268.34 -50.98 267.68 -52 267 C-53.7062353 257.47641062 -50.87040423 247.06139632 -49.0625 237.6875 C-48.89383423 236.79710022 -48.72516846 235.90670044 -48.5513916 234.98931885 C-38.11404119 180.03180856 -25.40329813 125.4695292 -13.06848526 70.91564369 C-11.53579046 64.13666191 -10.00873727 57.35642336 -8.48449326 50.57553673 C-7.44241838 45.94534847 -6.38346701 41.31937379 -5.31445312 36.6953125 C-4.84995716 34.65111055 -4.38573447 32.60684647 -3.921875 30.5625 C-3.71870667 29.7058374 -3.51553833 28.8491748 -3.30621338 27.96655273 C-1.83646322 21.40548392 -0.83868876 14.48393372 -3 8 C-14.08151583 8.24090252 -22.40969415 17.82371084 -30 25 C-30.66644531 25.61359375 -31.33289063 26.2271875 -32.01953125 26.859375 C-55.9595131 49.67793203 -82.85797002 89.67055129 -84.375 123.375 C-83.78361037 129.09176644 -82.35115372 133.26280236 -78.8125 137.8125 C-73.31815454 142.08587981 -67.74580837 143.29684377 -60.8828125 143.69140625 C-59 144 -59 144 -57 146 C-57.375 148.625 -57.375 148.625 -58 151 C-65.63374428 152.91187469 -73.49129717 150.89845341 -80.2890625 147.125 C-85.70027171 143.56694463 -89.59781334 138.34585006 -91.58984375 132.171875 C-96.67173504 105.26205062 -79.72694003 76.45050567 -65.25 55.1875 C-23.00212202 -4.66366048 -23.00212202 -4.66366048 0 0 Z M-36 211 C-35 214 -35 214 -35 214 Z '
                fill='#262626'
                transform='translate(281,128)'
              />
              <path
                d='M0 0 C4.33951204 2.89300802 5.50264592 5.8050401 6.66267776 10.79970741 C7.22058381 14.43882876 6.84330629 17.83077664 6.35302734 21.4597168 C6.25604239 22.24079898 6.15905743 23.02188116 6.05913353 23.8266325 C4.99455499 31.8861985 3.24298665 39.74588684 1.3515625 47.64453125 C0.98170634 49.22637761 0.61298454 50.80848955 0.24528503 52.39083862 C-0.54175073 55.77149854 -1.33421225 59.15081565 -2.13119507 62.52914429 C-4.28649471 71.67166668 -6.40021808 80.82384222 -8.51171875 89.9765625 C-8.73255693 90.93275923 -8.95339512 91.88895596 -9.18092537 92.87412834 C-14.76740623 117.09071782 -19.99068224 141.38483186 -25.1875 165.6875 C-25.63685668 167.78740534 -26.08621782 169.88730972 -26.5355835 171.98721313 C-29.03182957 183.65641944 -31.52014807 195.32729904 -34 207 C-33.5941568 205.91769104 -33.1883136 204.83538208 -32.77017212 203.72027588 C-32.2291061 202.27738427 -31.68803958 200.83449284 -31.14697266 199.39160156 C-30.8805043 198.68097565 -30.61403595 197.97034973 -30.3394928 197.2381897 C19.00310472 65.6547821 19.00310472 65.6547821 58.56640625 44.87890625 C63.96314734 42.92984245 69.44230648 43.22157154 74.875 44.875 C83.86270979 53.86270979 83.35880606 66.10570839 83.3828125 77.90112305 C83.14079205 109.36449353 77.30968909 140.96942643 72.6796875 172.00317383 C71.00134652 183.33102751 69.42171775 194.5460984 69 206 C69.804375 205.814375 70.60875 205.62875 71.4375 205.4375 C72.283125 205.293125 73.12875 205.14875 74 205 C74.33 205.33 74.66 205.66 75 206 C74.79412575 211.14685621 73.56670548 214.6631522 70.46875 218.6796875 C69 220 69 220 65.8125 220.5625 C63 220 63 220 61 218 C59.28173347 210.61611977 60.23851368 203.08081859 61.12109375 195.65234375 C61.32501991 193.84950172 61.32501991 193.84950172 61.5330658 192.01023865 C63.5060855 175.0281497 65.98456915 158.10951057 68.4019165 141.18634033 C73.4857438 108.35941566 73.4857438 108.35941566 75.25 75.25 C75.25773438 74.37085938 75.26546875 73.49171875 75.2734375 72.5859375 C75.25380213 65.96881733 74.68432199 59.45286009 71.75 53.4375 C70.02700895 51.81040605 70.02700895 51.81040605 67.4375 51.375 C52.66258808 54.06134762 42.63345137 69.23662021 34.54833984 80.72412109 C29.65374512 87.91860422 25.30658133 95.44415015 21 103 C20.51031738 103.85303711 20.02063477 104.70607422 19.51611328 105.58496094 C-5.30943266 149.0808235 -21.88119603 196.58749493 -36.625 244.26953125 C-36.82931137 244.92658554 -37.03362274 245.58363983 -37.24412537 246.26060486 C-38.22127948 249.41594327 -39.16235693 252.5759627 -40.05859375 255.75537109 C-40.55552734 257.49101318 -40.55552734 257.49101318 -41.0625 259.26171875 C-41.34222656 260.27580811 -41.62195312 261.28989746 -41.91015625 262.3347168 C-43.12837382 265.31394646 -44.59446846 266.89859816 -47 269 C-48.65 268.34 -50.3 267.68 -52 267 C-52.45459307 257.52188307 -50.73888839 248.57244184 -49.01171875 239.3046875 C-48.69369315 237.5681138 -48.37571622 235.83153118 -48.05778503 234.09494019 C-44.82104011 216.56181115 -41.14984018 199.12496346 -37.37072372 181.70197296 C-36.80066521 179.07036613 -36.23327497 176.43819671 -35.66665649 173.80584717 C-27.93803836 137.90833804 -19.9145566 102.07678216 -11.81745338 66.2608223 C-11.42917382 64.54311335 -11.04109758 62.82535842 -10.65323448 61.10755539 C-8.90262435 53.3545928 -7.14872371 45.60303986 -5.33203125 37.86523438 C-5.0930159 36.84037933 -4.85400055 35.81552429 -4.60774231 34.75961304 C-4.19187811 32.98235418 -3.77076896 31.20630704 -3.34233093 29.43203735 C-1.81668216 22.89854079 0.11420672 14.22841345 -3 8 C-16.7595738 8.72418809 -28.45520187 22.92079587 -37.171875 32.390625 C-58.94900958 56.78571737 -84.6987248 92.27313898 -83.4140625 126.51953125 C-82.65168 132.9278596 -81.06780461 136.32815797 -76.0625 140.375 C-71.6038012 142.5848791 -66.67924924 143.00382087 -61.79296875 143.60546875 C-59 144 -59 144 -57 145 C-57 146.98 -57 148.96 -57 151 C-65.00403876 152.79358795 -73.22952155 150.88523923 -80.5 147.25 C-87.63911195 140.82479924 -91.08601742 135.18773953 -92.31640625 125.51171875 C-93.96517654 90.46205345 -66.42579422 53.31480135 -44.25 28.625 C-43.52039062 27.83480469 -42.79078125 27.04460937 -42.0390625 26.23046875 C-40.16544973 24.18098045 -38.39681473 22.07459407 -36.625 19.9375 C-27.65972529 9.6885139 -14.38351313 -1.94800335 0 0 Z M-36 212 C-35 214 -35 214 -35 214 Z '
                fill='#262626'
                transform='translate(96,128)'
              />
              <path
                d='M0 0 C0.66 0.33 1.32 0.66 2 1 C-5.59 8.59 -13.18 16.18 -21 24 C-21.66 23.67 -22.32 23.34 -23 23 C-15.69568836 14.86710152 -8.2434374 7.18866687 0 0 Z '
                fill='#686868'
                transform='translate(257,136)'
              />
              <path
                d='M0 0 C0.66 0.33 1.32 0.66 2 1 C-3.94 6.94 -9.88 12.88 -16 19 C-16.66 18.67 -17.32 18.34 -18 18 C-6.66287016 5.33029613 -6.66287016 5.33029613 0 0 Z '
                fill='#616161'
                transform='translate(334,176)'
              />
              <path
                d='M0 0 C0.66 0.33 1.32 0.66 2 1 C-3.94 6.94 -9.88 12.88 -16 19 C-16.66 18.67 -17.32 18.34 -18 18 C-12.31481712 11.5575694 -6.66474693 5.45466718 0 0 Z '
                fill='#686868'
                transform='translate(71,137)'
              />
              <path
                d='M0 0 C0.66 0.33 1.32 0.66 2 1 C-2.62 5.62 -7.24 10.24 -12 15 C-12.66 14.67 -13.32 14.34 -14 14 C-12.60919892 12.41224451 -11.21211596 10.82999061 -9.8125 9.25 C-8.64654297 7.92742187 -8.64654297 7.92742187 -7.45703125 6.578125 C-5.11544754 4.12113732 -2.69841735 2.05137234 0 0 Z '
                fill='#696969'
                transform='translate(148,177)'
              />
              <path
                d='M0 0 C0.66 0.33 1.32 0.66 2 1 C-1.3 4.3 -4.6 7.6 -8 11 C-8 7.0234755 -6.61988497 5.9109833 -4 3 C-1.75 1.1875 -1.75 1.1875 0 0 Z '
                fill='#767676'
                transform='translate(397,250)'
              />
              <path
                d='M0 0 C0.2475 0.639375 0.495 1.27875 0.75 1.9375 C1.81562433 4.18741541 1.81562433 4.18741541 4.125 4.75 C4.74375 4.8325 5.3625 4.915 6 5 C4.02 5.99 2.04 6.98 0 8 C0 5.36 0 2.72 0 0 Z '
                fill='#979797'
                transform='translate(348,329)'
              />
              <path
                d='M0 0 C0.66 0.33 1.32 0.66 2 1 C-1.465 3.97 -1.465 3.97 -5 7 C-5 6.01 -5 5.02 -5 4 C-2.5 1.8125 -2.5 1.8125 0 0 Z '
                fill='#717171'
                transform='translate(449,251)'
              />
            </svg> */}
            <img src="/nnm_icon.png" alt="logo" className='h-8 w-8' />

            <div
              className={`pl-4 flex flex-col justify-end truncate ${isCollapsed ? 'invisible w-0' : 'visible w-auto'}`}
            >
              <span className='font-medium'>NNm</span>
              <span className='text-xs'>Admin</span>
            </div>
          </div>

          {/* Toggle Button in mobile */}
          <Button
            variant='ghost'
            size='icon'
            className='md:hidden'
            aria-label='Toggle Navigation'
            aria-controls='sidebar-menu'
            aria-expanded={navOpened}
            onClick={() => setNavOpened((prev) => !prev)}
          >
            {navOpened ? <IconX /> : <IconMenu2 />}
          </Button>
        </LayoutHeader>

        {/* Navigation links */}
        <Nav
          id='sidebar-menu'
          className={`h-full flex-1 overflow-auto ${navOpened ? 'max-h-screen' : 'max-h-0 py-0 md:max-h-screen md:py-2'}`}
          closeNav={() => setNavOpened(false)}
          isCollapsed={isCollapsed}
          links={sidelinks}
        />

        {/* Scrollbar width toggle button */}
        <Button
          onClick={() => setIsCollapsed((prev) => !prev)}
          size='icon'
          variant='outline'
          className='absolute -right-5 top-1/2 hidden rounded-full md:inline-flex'
        >
          <IconChevronsLeft
            stroke={1.5}
            className={`h-5 w-5 ${isCollapsed ? 'rotate-180' : ''}`}
          />
        </Button>
      </Layout>
    </aside>
  )
}
